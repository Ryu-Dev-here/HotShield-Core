(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[895],{4797:function(e,s,t){Promise.resolve().then(t.bind(t,5891))},5891:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return g}});var a,i,r=t(7437),d=t(2265),n=t(9376),l=t(4545);function c(e){let{timeline:s}=e;return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Timeline"}),(0,r.jsx)("div",{className:"space-y-2",children:s.map((e,s)=>(0,r.jsx)("div",{className:"flex items-start space-x-4 p-3 bg-gray-50 rounded",children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:e.from}),(0,r.jsx)("span",{children:"→"}),(0,r.jsx)("span",{className:"text-sm font-medium text-blue-600",children:e.to})]}),e.reason&&(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.reason}),e.actor&&(0,r.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["by ",e.actor]}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:new Date(e.timestamp).toLocaleString()})]})},s))})]})}function o(e){let{proofLinks:s,proofHashes:t}=e;return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Proof"}),(0,r.jsx)("div",{className:"space-y-2",children:s.map((e,s)=>(0,r.jsxs)("div",{className:"p-3 bg-gray-50 rounded",children:[(0,r.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline break-all",children:e}),t[s]&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1 font-mono",children:["Hash: ",t[s].substring(0,16),"..."]})]},s))})]})}function m(e){let{reporter:s}=e,t=s.reportCount>0?(s.verifiedCount/s.reportCount*100).toFixed(1):"0",a=s.reportCount>0?(s.clearedCount/s.reportCount*100).toFixed(1):"0";return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Reporter Metrics"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"p-3 bg-gray-50 rounded",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Trust Score"}),(0,r.jsxs)("p",{className:"text-2xl font-bold",children:[s.trustScore,"/100"]})]}),(0,r.jsxs)("div",{className:"p-3 bg-gray-50 rounded",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Total Reports"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:s.reportCount})]}),(0,r.jsxs)("div",{className:"p-3 bg-gray-50 rounded",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Verified"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-600",children:s.verifiedCount}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[t,"%"]})]}),(0,r.jsxs)("div",{className:"p-3 bg-gray-50 rounded",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Cleared"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-red-600",children:s.clearedCount}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[a,"%"]})]})]}),s.shadowBanned&&(0,r.jsx)("div",{className:"p-3 bg-red-100 border border-red-300 rounded",children:(0,r.jsx)("p",{className:"text-sm font-medium text-red-800",children:"Shadow Banned"})}),s.abuseFlags.length>0&&(0,r.jsxs)("div",{className:"p-3 bg-yellow-100 border border-yellow-300 rounded",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-yellow-800",children:"Abuse Flags"}),(0,r.jsx)("ul",{className:"text-xs text-yellow-700 mt-1 list-disc list-inside",children:s.abuseFlags.map((e,s)=>(0,r.jsx)("li",{children:e},s))})]})]})}var x=t(6334);function h(e){let{currentVerdict:s,onVerdictChange:t}=e,[a,n]=(0,d.useState)(s),[l,c]=(0,d.useState)(""),[o,m]=(0,d.useState)(!1),h=async()=>{if(a!==s){m(!0);try{await t(a,l),alert("Verdict updated successfully")}catch(e){alert("Failed to update verdict")}finally{m(!1)}}};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Change Verdict"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("select",{value:a,onChange:e=>n(e.target.value),className:"w-full p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:i.CLEAN,children:"CLEAN"}),(0,r.jsx)("option",{value:i.PENDING,children:"PENDING"}),(0,r.jsx)("option",{value:i.VERIFIED,children:"VERIFIED"}),(0,r.jsx)("option",{value:i.DISPUTED,children:"DISPUTED"}),(0,r.jsx)("option",{value:i.CLEARED,children:"CLEARED"})]}),(0,r.jsx)("textarea",{value:l,onChange:e=>c(e.target.value),placeholder:"Reason for change (optional)",className:"w-full p-2 border border-gray-300 rounded",rows:3}),(0,r.jsx)(x.z,{onClick:h,disabled:o||a===s,variant:"primary",children:o?"Updating...":"Update Verdict"})]})]})}(a=i||(i={})).CLEAN="CLEAN",a.PENDING="PENDING",a.VERIFIED="VERIFIED",a.DISPUTED="DISPUTED",a.CLEARED="CLEARED";var u=t(7648);function g(){let e=(0,n.useParams)(),s=(0,n.useRouter)(),[t,a]=(0,d.useState)(null),[i,g]=(0,d.useState)([]),[p,j]=(0,d.useState)([]),[N,f]=(0,d.useState)(!0);(0,d.useEffect)(()=>{e.uuid&&fetch("/api/admin/cases/".concat(e.uuid)).then(e=>{if(!e.ok){s.push("/admin/login");return}return e.json()}).then(e=>{e&&(a(e.case),g(e.reports),j(e.reporters)),f(!1)})},[e.uuid,s]);let b=async(s,i)=>{if(!(await fetch("/api/admin/cases/".concat(e.uuid,"/verdict"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({verdict:s,reason:i})})).ok)throw Error("Failed to update verdict");t&&a({...t,verdict:s})};return N?(0,r.jsxs)("div",{className:"min-h-screen bg-midnight-950",children:[(0,r.jsx)(l.w,{}),(0,r.jsx)("div",{className:"p-8 text-midnight-100",children:"Loading..."})]}):t?(0,r.jsxs)("div",{className:"min-h-screen bg-midnight-950",children:[(0,r.jsx)(l.w,{}),(0,r.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(u.default,{href:"/admin/cases",children:(0,r.jsx)(x.z,{variant:"secondary",className:"text-sm",children:"← Back to Cases"})})}),(0,r.jsxs)("div",{className:"bg-midnight-900 rounded-lg shadow-lg border border-midnight-800 p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4 text-midnight-100",children:"Case Details"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-midnight-300",children:"UUID"}),(0,r.jsx)("p",{className:"font-mono text-sm text-midnight-100",children:t.targetUuid})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-midnight-300",children:"Verdict"}),(0,r.jsx)("p",{className:"font-semibold text-midnight-100",children:t.verdict})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-midnight-300",children:"Confidence"}),(0,r.jsxs)("p",{className:"font-semibold text-midnight-100",children:[t.confidence,"%"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-midnight-300",children:"Reports"}),(0,r.jsx)("p",{className:"font-semibold text-midnight-100",children:t.reports.length})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsx)("div",{className:"bg-midnight-900 rounded-lg shadow-lg border border-midnight-800 p-6",children:(0,r.jsx)(c,{timeline:t.timeline})}),(0,r.jsx)("div",{className:"bg-midnight-900 rounded-lg shadow-lg border border-midnight-800 p-6",children:(0,r.jsx)(h,{currentVerdict:t.verdict,onVerdictChange:b})})]}),(0,r.jsxs)("div",{className:"mt-6 bg-midnight-900 rounded-lg shadow-lg border border-midnight-800 p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4 text-midnight-100",children:"Reports"}),(0,r.jsx)("div",{className:"space-y-4",children:i.map((e,s)=>{let t=p.find(s=>s.fingerprint===e.reporterFingerprint);return(0,r.jsxs)("div",{className:"border border-midnight-800 rounded p-4 bg-midnight-800",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,r.jsx)("span",{className:"font-medium text-midnight-100",children:e.category}),(0,r.jsx)("span",{className:"text-sm text-midnight-400",children:new Date(e.timestamp).toLocaleString()})]}),(0,r.jsx)("p",{className:"text-sm text-midnight-200 mb-2",children:e.description}),(0,r.jsx)(o,{proofLinks:e.proofLinks,proofHashes:e.proofHashes}),t&&(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(m,{reporter:t})})]},s)})})]})]})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-midnight-950",children:[(0,r.jsx)(l.w,{}),(0,r.jsx)("div",{className:"p-8 text-midnight-100",children:"Case not found"})]})}},4545:function(e,s,t){"use strict";t.d(s,{w:function(){return n}});var a=t(7437);t(2265);var i=t(9376),r=t(7648),d=t(6334);function n(){let e=(0,i.useRouter)(),s=(0,i.usePathname)(),t=async()=>{await fetch("/api/admin/logout",{method:"POST"}),e.push("/admin/login")};return(0,a.jsx)("nav",{className:"bg-midnight-900 shadow-lg border-b border-midnight-800",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16 items-center",children:[(0,a.jsx)(r.default,{href:"/admin/dashboard",className:"text-xl font-semibold text-midnight-100 hover:text-midnight-300",children:"HotShield Admin"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(r.default,{href:"/admin/dashboard",children:(0,a.jsx)(d.z,{variant:"/admin/dashboard"===s?"primary":"secondary",className:"text-sm",children:"Dashboard"})}),(0,a.jsx)(r.default,{href:"/admin/cases",children:(0,a.jsx)(d.z,{variant:"/admin/cases"===s||(null==s?void 0:s.startsWith("/admin/cases/"))?"primary":"secondary",className:"text-sm",children:"Cases"})}),(0,a.jsx)(r.default,{href:"/admin/reporters",children:(0,a.jsx)(d.z,{variant:"/admin/reporters"===s?"primary":"secondary",className:"text-sm",children:"Reporters"})}),(0,a.jsx)(r.default,{href:"/admin/audit",children:(0,a.jsx)(d.z,{variant:"/admin/audit"===s?"primary":"secondary",className:"text-sm",children:"Audit Log"})}),(0,a.jsx)(d.z,{variant:"secondary",onClick:t,className:"text-sm",children:"Logout"})]})]})})})}},6334:function(e,s,t){"use strict";t.d(s,{z:function(){return i}});var a=t(7437);function i(e){let{variant:s="primary",className:t="",children:i,...r}=e;return(0,a.jsx)("button",{className:"".concat("px-4 py-2 rounded font-medium transition-colors"," ").concat({primary:"bg-midnight-600 text-white hover:bg-midnight-700",secondary:"bg-midnight-800 text-midnight-100 hover:bg-midnight-700 border border-midnight-600",danger:"bg-red-600 text-white hover:bg-red-700"}[s]," ").concat(t),...r,children:i})}t(2265)}},function(e){e.O(0,[448,971,117,744],function(){return e(e.s=4797)}),_N_E=e.O()}]);