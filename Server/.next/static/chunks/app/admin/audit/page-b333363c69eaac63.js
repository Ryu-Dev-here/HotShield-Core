(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[708],{8440:function(e,t,i){Promise.resolve().then(i.bind(i,4005))},4005:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return o}});var n=i(7437),s=i(2265),a=i(9376),r=i(4545),d=i(1515);function o(){let[e,t]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[l,c]=(0,s.useState)("all"),[m,h]=(0,s.useState)(""),x=(0,a.useRouter)();(0,s.useEffect)(()=>{fetch("/api/admin/audit").then(e=>{if(!e.ok){x.push("/admin/login");return}return e.json()}).then(e=>{e&&t(e),o(!1)})},[x]);let u=e.filter(e=>{if("all"!==l&&e.action!==l)return!1;if(m){var t,i,n;let s=m.toLowerCase();return(null===(t=e.actor)||void 0===t?void 0:t.toLowerCase().includes(s))||(null===(i=e.target)||void 0===i?void 0:i.toLowerCase().includes(s))||(null===(n=e.action)||void 0===n?void 0:n.toLowerCase().includes(s))}return!0}),g={REPORT_CREATED:"bg-blue-900 text-blue-200",VERDICT_CHANGED:"bg-purple-900 text-purple-200",REPORTER_BANNED:"bg-red-900 text-red-200",CASE_VIEWED:"bg-midnight-800 text-midnight-200",ADMIN_LOGIN:"bg-green-900 text-green-200",ADMIN_LOGOUT:"bg-yellow-900 text-yellow-200",STATE_TRANSITION:"bg-indigo-900 text-indigo-200"},p=Array.from(new Set(e.map(e=>e.action)));return i?(0,n.jsxs)("div",{className:"min-h-screen bg-midnight-950",children:[(0,n.jsx)(r.w,{}),(0,n.jsx)("div",{className:"p-8 text-midnight-100",children:"Loading..."})]}):(0,n.jsxs)("div",{className:"min-h-screen bg-midnight-950",children:[(0,n.jsx)(r.w,{}),(0,n.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-4 text-midnight-100",children:"Audit Log"}),(0,n.jsxs)("div",{className:"flex space-x-4 mb-4",children:[(0,n.jsx)("input",{type:"text",placeholder:"Search by actor, target, or action...",value:m,onChange:e=>h(e.target.value),className:"px-4 py-2 border border-midnight-700 rounded flex-1 max-w-md bg-midnight-800 text-midnight-100 placeholder-midnight-400 focus:outline-none focus:ring-2 focus:ring-midnight-600"}),(0,n.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"px-4 py-2 border border-midnight-700 rounded bg-midnight-800 text-midnight-100 focus:outline-none focus:ring-2 focus:ring-midnight-600",children:[(0,n.jsx)("option",{value:"all",children:"All Actions"}),p.map(e=>(0,n.jsx)("option",{value:e,children:e.replace(/_/g," ")},e))]})]})]}),(0,n.jsxs)("div",{className:"bg-midnight-900 rounded-lg shadow-lg border border-midnight-800 overflow-hidden",children:[(0,n.jsx)(d.i,{headers:["Timestamp","Action","Actor","Target","Before","After","IP Address"],children:u.map((e,t)=>{var i;return(0,n.jsxs)("tr",{className:"border-b border-midnight-800",children:[(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-midnight-200",children:new Date(e.timestamp).toLocaleString()}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat(g[e.action]||"bg-midnight-800 text-midnight-200"),children:e.action.replace(/_/g," ")})}),(0,n.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-midnight-200",children:[null===(i=e.actor)||void 0===i?void 0:i.substring(0,16),"..."]}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-midnight-200",children:e.target?"".concat(e.target.substring(0,16),"..."):"-"}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-midnight-300",children:e.beforeState||"-"}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-midnight-300",children:e.afterState||"-"}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-midnight-400",children:e.ipAddress||"-"})]},t)})}),0===u.length&&(0,n.jsx)("div",{className:"text-center py-8 text-midnight-400",children:"No audit logs found"})]})]})]})}},4545:function(e,t,i){"use strict";i.d(t,{w:function(){return d}});var n=i(7437);i(2265);var s=i(9376),a=i(7648),r=i(6334);function d(){let e=(0,s.useRouter)(),t=(0,s.usePathname)(),i=async()=>{await fetch("/api/admin/logout",{method:"POST"}),e.push("/admin/login")};return(0,n.jsx)("nav",{className:"bg-midnight-900 shadow-lg border-b border-midnight-800",children:(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"flex justify-between h-16 items-center",children:[(0,n.jsx)(a.default,{href:"/admin/dashboard",className:"text-xl font-semibold text-midnight-100 hover:text-midnight-300",children:"HotShield Admin"}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)(a.default,{href:"/admin/dashboard",children:(0,n.jsx)(r.z,{variant:"/admin/dashboard"===t?"primary":"secondary",className:"text-sm",children:"Dashboard"})}),(0,n.jsx)(a.default,{href:"/admin/cases",children:(0,n.jsx)(r.z,{variant:"/admin/cases"===t||(null==t?void 0:t.startsWith("/admin/cases/"))?"primary":"secondary",className:"text-sm",children:"Cases"})}),(0,n.jsx)(a.default,{href:"/admin/reporters",children:(0,n.jsx)(r.z,{variant:"/admin/reporters"===t?"primary":"secondary",className:"text-sm",children:"Reporters"})}),(0,n.jsx)(a.default,{href:"/admin/audit",children:(0,n.jsx)(r.z,{variant:"/admin/audit"===t?"primary":"secondary",className:"text-sm",children:"Audit Log"})}),(0,n.jsx)(r.z,{variant:"secondary",onClick:i,className:"text-sm",children:"Logout"})]})]})})})}},6334:function(e,t,i){"use strict";i.d(t,{z:function(){return s}});var n=i(7437);function s(e){let{variant:t="primary",className:i="",children:s,...a}=e;return(0,n.jsx)("button",{className:"".concat("px-4 py-2 rounded font-medium transition-colors"," ").concat({primary:"bg-midnight-600 text-white hover:bg-midnight-700",secondary:"bg-midnight-800 text-midnight-100 hover:bg-midnight-700 border border-midnight-600",danger:"bg-red-600 text-white hover:bg-red-700"}[t]," ").concat(i),...a,children:s})}i(2265)},1515:function(e,t,i){"use strict";i.d(t,{i:function(){return s}});var n=i(7437);function s(e){let{headers:t,children:i}=e;return(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full bg-midnight-900 border border-midnight-800",children:[(0,n.jsx)("thead",{className:"bg-midnight-800",children:(0,n.jsx)("tr",{children:t.map((e,t)=>(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-midnight-300 uppercase tracking-wider border-b border-midnight-700",children:e},t))})}),(0,n.jsx)("tbody",{className:"divide-y divide-midnight-800",children:i})]})})}i(2265)}},function(e){e.O(0,[448,971,117,744],function(){return e(e.s=8440)}),_N_E=e.O()}]);