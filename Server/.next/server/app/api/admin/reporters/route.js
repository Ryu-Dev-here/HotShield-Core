"use strict";(()=>{var e={};e.id=459,e.ids=[459],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},4424:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>m,patchFetch:()=>g,requestAsyncStorage:()=>w,routeModule:()=>p,serverHooks:()=>f,staticGenerationAsyncStorage:()=>h});var r={};n.r(r),n.d(r,{GET:()=>d});var a=n(9303),i=n(8716),o=n(670),s=n(7070),c=n(3482),u=n(8484),l=n(2631);async function d(e){if(!await (0,c.kF)(e))return s.NextResponse.json({error:"Unauthorized"},{status:401});try{let t=await (0,u.N)(),n=new l.F(t),r=e.nextUrl.searchParams,a=parseInt(r.get("limit")||"100",10),i=await n.findAll(a);return s.NextResponse.json(i)}catch(e){return console.error("Error fetching reporters:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/reporters/route",pathname:"/api/admin/reporters",filename:"route",bundlePath:"app/api/admin/reporters/route"},resolvedPagePath:"C:\\Users\\Admin\\Documents\\Project\\HotShield\\Server\\src\\app\\api\\admin\\reporters\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:w,staticGenerationAsyncStorage:h,serverHooks:f}=p,m="/api/admin/reporters/route";function g(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:h})}},2631:(e,t,n)=>{n.d(t,{F:()=>r});class r{constructor(e){this.collection=e.collection("reporters"),this.ensureIndexes()}async ensureIndexes(){await this.collection.createIndex({fingerprint:1},{unique:!0}),await this.collection.createIndex({trustScore:-1}),await this.collection.createIndex({shadowBanned:1})}async findOrCreate(e){let t=await this.collection.findOne({fingerprint:e});if(t)return t;let n={fingerprint:e,trustScore:50,reportCount:0,verifiedCount:0,clearedCount:0,abuseFlags:[],shadowBanned:!1,createdAt:new Date().toISOString()};return await this.collection.insertOne(n),n}async findByFingerprint(e){return this.collection.findOne({fingerprint:e})}async update(e){await this.collection.updateOne({fingerprint:e.fingerprint},{$set:e})}async incrementReportCount(e){await this.collection.updateOne({fingerprint:e},{$inc:{reportCount:1},$set:{lastReportTime:new Date().toISOString()}})}async adjustTrustScore(e,t){let n=await this.findByFingerprint(e);if(!n)return;let r=Math.max(0,Math.min(100,n.trustScore+t));await this.collection.updateOne({fingerprint:e},{$set:{trustScore:r}})}async addAbuseFlag(e,t){await this.collection.updateOne({fingerprint:e},{$addToSet:{abuseFlags:t}})}async setShadowBanned(e,t){await this.collection.updateOne({fingerprint:e},{$set:{shadowBanned:t}})}async findAll(e=100){return this.collection.find({}).sort({trustScore:-1}).limit(e).toArray()}}},8484:(e,t,n)=>{n.d(t,{N:()=>s});let r=require("mongodb"),a=process.env.MONGODB_URI,i={},o=null;async function s(){return(await function(){if(!process.env.MONGODB_URI)throw Error("Please add your Mongo URI to .env.local");return o||(o=new r.MongoClient(a,i).connect())}()).db()}},3482:(e,t,n)=>{n.d(t,{uV:()=>l,ed:()=>p,sd:()=>h,kF:()=>m,ZW:()=>d});var r=n(8484),a=n(2023),i=n.n(a),o=n(4770),s=n.n(o);async function c(){return(await (0,r.N)()).collection("admins")}async function u(){return(await (0,r.N)()).collection("sessions")}async function l(e,t){let n=await c(),r=await i().hash(t,10);await n.insertOne({username:e,passwordHash:r,createdAt:new Date().toISOString()})}async function d(e,t){let n=await c(),r=await n.findOne({username:e});return!!r&&i().compare(t,r.passwordHash)}async function p(e,t){let n=await u(),r=s().randomBytes(32).toString("hex"),a=new Date(Date.now()+864e5).toISOString();return await n.insertOne({sessionId:r,username:e,expiresAt:a,ipAddress:t}),r}async function w(e){let t=await u(),n=await t.findOne({sessionId:e});return n?new Date(n.expiresAt)<new Date?(await t.deleteOne({sessionId:e}),null):n.username:null}async function h(e){let t=await u();await t.deleteOne({sessionId:e})}var f=n(1615);async function m(e){let t=await (0,f.cookies)(),n=e.headers.get("X-Session-Id")||t.get("sessionId")?.value||"";if(!n)return null;let r=await w(n);return r?{username:r}:null}}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[276,972,28],()=>n(4424));module.exports=r})();