"use strict";(()=>{var e={};e.id=881,e.ids=[881],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1583:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>D,patchFetch:()=>v,requestAsyncStorage:()=>I,routeModule:()=>h,serverHooks:()=>m,staticGenerationAsyncStorage:()=>f});var n={};r.r(n),r.d(n,{GET:()=>E,dynamic:()=>l,revalidate:()=>p});var a=r(9303),i=r(8716),s=r(670),o=r(7070),c=r(8484),u=r(1590),d=r(9066);let l="force-dynamic",p=60;async function E(e,{params:t}){try{let e=t.uuid,r=`scammers:${e}`,n=(0,d.q9)(r);if(n)return o.NextResponse.json(n,{headers:{"Cache-Control":"public, s-maxage=300, stale-while-revalidate=60","X-Cache":"HIT"}});let a=await (0,c.N)(),i=new u.Z(a),s=await i.findByUuid(e);if(!s)return o.NextResponse.json({error:"Not found"},{status:404});let l=(0,d.lk)(s);if(!l)return o.NextResponse.json({error:"Not found"},{status:404});return(0,d.Zi)(r,l,3e5),o.NextResponse.json(l,{headers:{"Cache-Control":"public, s-maxage=300, stale-while-revalidate=60","X-Cache":"MISS"}})}catch(e){return console.error("Error fetching scammer:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/scammers/[uuid]/route",pathname:"/api/scammers/[uuid]",filename:"route",bundlePath:"app/api/scammers/[uuid]/route"},resolvedPagePath:"C:\\Users\\Admin\\Documents\\Project\\HotShield\\Server\\src\\app\\api\\scammers\\[uuid]\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:I,staticGenerationAsyncStorage:f,serverHooks:m}=h,D="/api/scammers/[uuid]/route";function v(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:f})}},1590:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(6338);class a{constructor(e){this.collection=e.collection("cases"),this.ensureIndexes()}async ensureIndexes(){await this.collection.createIndex({targetUuid:1},{unique:!0}),await this.collection.createIndex({verdict:1}),await this.collection.createIndex({confidence:-1}),await this.collection.createIndex({lastUpdated:-1})}async create(e){await this.collection.insertOne(e)}async findByUuid(e){return this.collection.findOne({targetUuid:e})}async update(e){await this.collection.updateOne({targetUuid:e.targetUuid},{$set:e},{upsert:!0})}async findAllByVerdict(e){return this.collection.find({verdict:e}).toArray()}async findAllVerifiedAndPending(){return this.collection.find({verdict:{$in:[n.j.VERIFIED,n.j.PENDING]}}).toArray()}async updateVerdict(e,t,r){await this.collection.updateOne({targetUuid:e},{$set:{verdict:t,lastUpdated:new Date().toISOString()},$push:{timeline:r}})}}},8484:(e,t,r)=>{r.d(t,{N:()=>o});let n=require("mongodb"),a=process.env.MONGODB_URI,i={},s=null;async function o(){return(await function(){if(!process.env.MONGODB_URI)throw Error("Please add your Mongo URI to .env.local");return s||(s=new n.MongoClient(a,i).connect())}()).db()}},9066:(e,t,r)=>{r.d(t,{lk:()=>a,q9:()=>o,Zi:()=>c});var n=r(6338);function a(e){if(e.verdict===n.j.CLEAN||e.verdict===n.j.CLEARED)return null;let t={[n.j.VERIFIED]:"VERIFIED",[n.j.PENDING]:"PENDING",[n.j.DISPUTED]:"DISPUTED",[n.j.CLEAN]:null,[n.j.CLEARED]:null}[e.verdict];if(!t)return null;let r=e.patternMatches||[];return{uuid:e.targetUuid,status:t,confidence:e.confidence,reasonTags:r,lastUpdated:e.lastUpdated}}let i=new Map,s=1e3*parseInt(process.env.CDN_CACHE_TTL||"300",10);function o(e){let t=i.get(e);return t?Date.now()>t.expires?(i.delete(e),null):t.data:null}function c(e,t,r=s){i.set(e,{data:t,expires:Date.now()+r})}},6338:(e,t,r)=>{var n;r.d(t,{j:()=>n}),function(e){e.CLEAN="CLEAN",e.PENDING="PENDING",e.VERIFIED="VERIFIED",e.DISPUTED="DISPUTED",e.CLEARED="CLEARED"}(n||(n={}))}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,972],()=>r(1583));module.exports=n})();