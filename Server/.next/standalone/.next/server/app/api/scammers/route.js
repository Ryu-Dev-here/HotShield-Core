"use strict";(()=>{var e={};e.id=510,e.ids=[510],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8771:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>D,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>f,staticGenerationAsyncStorage:()=>I});var r={};n.r(r),n.d(r,{GET:()=>E,dynamic:()=>u,revalidate:()=>p});var a=n(9303),i=n(8716),s=n(670),o=n(7070),c=n(8484),l=n(1590),d=n(9066);let u="force-dynamic",p=60;async function E(e){try{let e="scammers:all",t=(0,d.q9)(e);if(t)return o.NextResponse.json(t,{headers:{"Cache-Control":"public, s-maxage=300, stale-while-revalidate=60","X-Cache":"HIT"}});let n=await (0,c.N)(),r=new l.Z(n),a=(await r.findAllVerifiedAndPending()).map(e=>(0,d.lk)(e)).filter(e=>null!==e);return(0,d.Zi)(e,a,3e5),o.NextResponse.json(a,{headers:{"Cache-Control":"public, s-maxage=300, stale-while-revalidate=60","X-Cache":"MISS"}})}catch(e){return console.error("Error fetching scammers:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/scammers/route",pathname:"/api/scammers",filename:"route",bundlePath:"app/api/scammers/route"},resolvedPagePath:"C:\\Users\\Admin\\Documents\\Project\\HotShield\\Server\\src\\app\\api\\scammers\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:I,serverHooks:f}=h,D="/api/scammers/route";function v(){return(0,s.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:I})}},1590:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(6338);class a{constructor(e){this.collection=e.collection("cases"),this.ensureIndexes()}async ensureIndexes(){await this.collection.createIndex({targetUuid:1},{unique:!0}),await this.collection.createIndex({verdict:1}),await this.collection.createIndex({confidence:-1}),await this.collection.createIndex({lastUpdated:-1})}async create(e){await this.collection.insertOne(e)}async findByUuid(e){return this.collection.findOne({targetUuid:e})}async update(e){await this.collection.updateOne({targetUuid:e.targetUuid},{$set:e},{upsert:!0})}async findAllByVerdict(e){return this.collection.find({verdict:e}).toArray()}async findAllVerifiedAndPending(){return this.collection.find({verdict:{$in:[r.j.VERIFIED,r.j.PENDING]}}).toArray()}async updateVerdict(e,t,n){await this.collection.updateOne({targetUuid:e},{$set:{verdict:t,lastUpdated:new Date().toISOString()},$push:{timeline:n}})}}},8484:(e,t,n)=>{n.d(t,{N:()=>o});let r=require("mongodb"),a=process.env.MONGODB_URI,i={},s=null;async function o(){return(await function(){if(!process.env.MONGODB_URI)throw Error("Please add your Mongo URI to .env.local");return s||(s=new r.MongoClient(a,i).connect())}()).db()}},9066:(e,t,n)=>{n.d(t,{lk:()=>a,q9:()=>o,Zi:()=>c});var r=n(6338);function a(e){if(e.verdict===r.j.CLEAN||e.verdict===r.j.CLEARED)return null;let t={[r.j.VERIFIED]:"VERIFIED",[r.j.PENDING]:"PENDING",[r.j.DISPUTED]:"DISPUTED",[r.j.CLEAN]:null,[r.j.CLEARED]:null}[e.verdict];if(!t)return null;let n=e.patternMatches||[];return{uuid:e.targetUuid,status:t,confidence:e.confidence,reasonTags:n,lastUpdated:e.lastUpdated}}let i=new Map,s=1e3*parseInt(process.env.CDN_CACHE_TTL||"300",10);function o(e){let t=i.get(e);return t?Date.now()>t.expires?(i.delete(e),null):t.data:null}function c(e,t,n=s){i.set(e,{data:t,expires:Date.now()+n})}},6338:(e,t,n)=>{var r;n.d(t,{j:()=>r}),function(e){e.CLEAN="CLEAN",e.PENDING="PENDING",e.VERIFIED="VERIFIED",e.DISPUTED="DISPUTED",e.CLEARED="CLEARED"}(r||(r={}))}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[276,972],()=>n(8771));module.exports=r})();